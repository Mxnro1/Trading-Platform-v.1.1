<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Chart</title>
    <link rel="stylesheet" href="style.css">
    <!-- –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –≤–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
    <script src="https://unpkg.com/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body data-theme="light">
    <div class="container">
        <header>
            <div class="header-main">
                <img src="–∑–∞–≥—Ä—É–∑–∫–∞.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="header-logo"/>
                <h1>–¢–æ—Ä–≥–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞</h1>
            </div>
            <div class="tabs">
                <button class="tab-button active" data-tab="chart">–ì—Ä–∞—Ñ–∏–∫</button>
                <button class="tab-button" data-tab="monitor">–ú–æ–Ω–∏—Ç–æ—Ä</button>
                <button class="tab-button" data-tab="converter">–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è</button>
                <button class="tab-button" data-tab="orderbook">–°—Ç–∞–∫–∞–Ω</button>
                <button class="tab-button" data-tab="probability">–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è</button>
                <button class="tab-button" data-tab="news">–ù–æ–≤–æ—Å—Ç–∏ –∏ —Å–æ–±—ã—Ç–∏—è</button>
            </div>
        </header>
        <main class="content-wrapper">
            <!-- –í–∫–ª–∞–¥–∫–∞ —Å –≥—Ä–∞—Ñ–∏–∫–æ–º -->
            <div class="tab-content active" id="chart-tab">
                <div class="crypto-selector">
                    <select id="cryptoSymbol">
                        <option value="BTCUSDT">Bitcoin (BTC)</option>
                        <option value="TRXUSDT">Tron (TRX)</option>
                        <option value="ETHUSDT">Ethereum (ETH)</option>
                        <option value="BNBUSDT">Binance Coin (BNB)</option>
                        <option value="ADAUSDT">Cardano (ADA)</option>
                        <option value="DOGEUSDT">Dogecoin (DOGE)</option>
                        <option value="XRPUSDT">Ripple (XRP)</option>
                        <option value="SOLUSDT">Solana (SOL)</option>
                        <option value="DOTUSDT">Polkadot (DOT)</option>
                        <option value="MATICUSDT">Polygon (MATIC)</option>
                        <option value="SUIUSDT">Sui (SUI)</option>
                        <option value="AVAXUSDT">Avalanche (AVAX)</option>
                        <option value="LINKUSDT">Chainlink (LINK)</option>
                    </select>
                </div>
                <div class="controls">
                    <div class="interval-buttons">
                        <button class="interval-btn" data-interval="15m">15 –º–∏–Ω</button>
                        <button class="interval-btn" data-interval="30m">30 –º–∏–Ω</button>
                        <button class="interval-btn" data-interval="1h">1 —á–∞—Å</button>
                        <button class="interval-btn" data-interval="1d">1 –¥–µ–Ω—å</button>
                    </div>
                    <div class="date-range">
                        <input type="date" id="startDate">
                        <input type="date" id="endDate">
                    </div>
                    <button id="themeToggle">üåì</button>
                </div>

                <div class="chart-container">
                    <!-- –ì—Ä–∞—Ñ–∏–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å -->
                </div>

                <div id="candleInfo" class="candle-info">
                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–≤–µ—á–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–¥–µ—Å—å -->
                </div>

                <div class="tools-panel">
                    <button id="fibonacciTool">–§–∏–±–æ–Ω–∞—á—á–∏</button>
                    <button id="removeFibonacci">–£–¥–∞–ª–∏—Ç—å –§–∏–±–æ–Ω–∞—á—á–∏</button>
                    <button id="clearChart">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
                    <button id="exportCSV">–≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                </div>

                <div class="grid-bot-calculator">
                    <h3>–†–∞—Å—á–µ—Ç –ì—Ä–∏–¥-–ë–æ—Ç–∞</h3>
                    <div class="grid-inputs">
                        <div class="form-group">
                            <label for="buyPrice">–¶–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏</label>
                            <input type="number" id="buyPrice" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="sellPrice">–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏</label>
                            <input type="number" id="sellPrice" step="0.01">
                        </div>
                        <button id="calculateGrid">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
                    </div>
                    <div id="gridResult" class="grid-result"></div>
                    <div id="gridTradeLog" class="grid-trade-log">
                        <h4>–õ–æ–≥ —Å–¥–µ–ª–æ–∫</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>–í—Ä–µ–º—è</th>
                                    <th>–¢–∏–ø</th>
                                    <th>–¶–µ–Ω–∞</th>
                                </tr>
                            </thead>
                            <tbody id="gridTradeLogBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∞ -->
            <div class="tab-content" id="monitor-tab">
                <div class="monitor-container">
                    <div class="monitor-header">
                        <h2>–ú–æ–Ω–∏—Ç–æ—Ä –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç</h2>
                        <div class="monitor-controls">
                            <button id="refreshMonitor">–û–±–Ω–æ–≤–∏—Ç—å</button>
                            <select id="monitorInterval">
                                <option value="1m">1 –º–∏–Ω—É—Ç–∞</option>
                                <option value="5m">5 –º–∏–Ω—É—Ç</option>
                                <option value="15m">15 –º–∏–Ω—É—Ç</option>
                                <option value="1h">1 —á–∞—Å</option>
                            </select>
                        </div>
                    </div>
                    <div class="monitor-grid">
                        <table id="monitorTable">
                            <thead>
                                <tr>
                                    <th>–ü–∞—Ä–∞</th>
                                    <th>–¶–µ–Ω–∞</th>
                                    <th>–ò–∑–º–µ–Ω–µ–Ω–∏–µ (24—á)</th>
                                    <th>–û–±—ä–µ–º (24—á)</th>
                                    <th>–ú–∞–∫—Å. —Ü–µ–Ω–∞</th>
                                    <th>–ú–∏–Ω. —Ü–µ–Ω–∞</th>
                                    <th>RSI</th>
                                    <th>–¢—Ä–µ–Ω–¥</th>
                                    <th>–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (24—á)</th>
                                </tr>
                            </thead>
                            <tbody id="monitorTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ -->
            <div class="tab-content" id="converter-tab">
              <div id="crypto-converter">
                <h3>–ö—Ä–∏–ø—Ç–æ-–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä</h3>
                <input type="number" id="cc-amount" placeholder="–°—É–º–º–∞" value="1" />
                <select id="cc-from"></select>
                <button id="cc-swap">‚áÑ</button>
                <select id="cc-to"></select>
                <button id="cc-convert">–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                <button id="cc-auto">–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</button>
                <h3 id="cc-result">–†–µ–∑—É–ª—å—Ç–∞—Ç: ...</h3>
                <div class="converter-actions">
                  <button id="cc-export">–≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏</button>
                  <button id="cc-clear">–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
                </div>
                <div id="cc-history"><strong>–ò—Å—Ç–æ—Ä–∏—è:</strong></div>
              </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –°—Ç–∞–∫–∞–Ω -->
            <div class="tab-content" id="orderbook-tab">
              <div id="orderbook-container">
                <h3>–ë–∏—Ä–∂–µ–≤–æ–π —Å—Ç–∞–∫–∞–Ω (Orderbook)</h3>
                <div class="orderbook-info">
                  <p><b>–°—Ç–∞–∫–∞–Ω</b> ‚Äî —ç—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –∑–∞—è–≤–æ–∫ –Ω–∞ –ø–æ–∫—É–ø–∫—É (Bid) –∏ –ø—Ä–æ–¥–∞–∂—É (Ask) –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥–ª—É–±–∏–Ω—É —Ä—ã–Ω–∫–∞, –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∏ –∫—Ä—É–ø–Ω—ã–µ –ª–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞.</p>
                  <ul class="orderbook-hints">
                    <li><b>–°—Ç–µ–Ω–∞ <span class="tooltip" title="–ö—Ä—É–ø–Ω–∞—è –∑–∞—è–≤–∫–∞, –æ–±—ä—ë–º –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–µ–≤—ã—à–∞–µ—Ç 10% –æ—Ç —Å—É–º–º—ã –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫ –≤ —Å—Ç–∞–∫–∞–Ω–µ. –ú–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —Å–∏–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–ª–∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è.">?</span></b> ‚Äî –∫—Ä—É–ø–Ω–∞—è –ª–∏–º–∏—Ç–Ω–∞—è –∑–∞—è–≤–∫–∞, –≤—ã–¥–µ–ª—è–µ—Ç—Å—è —Ü–≤–µ—Ç–æ–º.</li>
                    <li><b>–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ <span class="tooltip" title="–í–∏–∑—É–∞–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∑–∞—è–≤–æ–∫ —Ü–≤–µ—Ç–æ–º: —á–µ–º –Ω–∞—Å—ã—â–µ–Ω–Ω–µ–µ —Ü–≤–µ—Ç ‚Äî —Ç–µ–º –±–æ–ª—å—à–µ –æ–±—ä—ë–º.">?</span></b> ‚Äî —Ü–≤–µ—Ç–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–ª–æ—Ç–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π.</li>
                    <li><b>–°–ø—Ä–µ–¥ <span class="tooltip" title="–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ª—É—á—à–µ–π —Ü–µ–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏. –ß–µ–º –º–µ–Ω—å—à–µ —Å–ø—Ä–µ–¥ ‚Äî —Ç–µ–º –ª–∏–∫–≤–∏–¥–Ω–µ–µ —Ä—ã–Ω–æ–∫.">?</span></b> ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ª—É—á—à–µ–π —Ü–µ–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏.</li>
                    <li><b>–õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å <span class="tooltip" title="–°—É–º–º–∞—Ä–Ω—ã–π –æ–±—ä—ë–º –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫ –Ω–∞ –ø–æ–∫—É–ø–∫—É –∏–ª–∏ –ø—Ä–æ–¥–∞–∂—É –≤ —Å—Ç–∞–∫–∞–Ω–µ.">?</span></b> ‚Äî –æ–±—â–∏–π –æ–±—ä—ë–º –∑–∞—è–≤–æ–∫ –Ω–∞ –ø–æ–∫—É–ø–∫—É/–ø—Ä–æ–¥–∞–∂—É.</li>
                  </ul>
                </div>
                <div class="orderbook-controls">
                  <label for="orderbook-symbol">–ú–æ–Ω–µ—Ç–∞:</label>
                  <select id="orderbook-symbol">
                    <option value="BTCUSDT">BTC/USDT</option>
                    <option value="ETHUSDT">ETH/USDT</option>
                    <option value="BNBUSDT">BNB/USDT</option>
                    <option value="TRXUSDT">TRX/USDT</option>
                    <option value="ADAUSDT">ADA/USDT</option>
                    <option value="DOGEUSDT">DOGE/USDT</option>
                    <option value="XRPUSDT">XRP/USDT</option>
                    <option value="SOLUSDT">SOL/USDT</option>
                    <option value="DOTUSDT">DOT/USDT</option>
                    <option value="MATICUSDT">MATIC/USDT</option>
                    <option value="SUIUSDT">SUI/USDT</option>
                    <option value="AVAXUSDT">AVAX/USDT</option>
                    <option value="LINKUSDT">LINK/USDT</option>
                  </select>
                  <input type="number" id="orderbook-volume-filter" min="0" step="0.0001" placeholder="–ú–∏–Ω. –æ–±—ä—ë–º" style="width:110px" title="–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞—è–≤–∫–∏ —Å –æ–±—ä—ë–º–æ–º –±–æ–ª—å—à–µ —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è">
                  <button id="orderbook-refresh" title="–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞–∫–∞–Ω –≤—Ä—É—á–Ω—É—é">ÔøΩÔøΩ –û–±–Ω–æ–≤–∏—Ç—å</button>
                  <button id="orderbook-export" title="–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–∫–∞–Ω –≤ CSV">‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç</button>
                  <span id="orderbook-spread"></span>
                </div>
                <div class="orderbook-table-wrapper">
                  <table id="orderbook-table">
                    <thead>
                      <tr>
                        <th class="ask-col" colspan="3">–ü—Ä–æ–¥–∞–∂–∞ (Ask)</th>
                        <th></th>
                        <th class="bid-col" colspan="3">–ü–æ–∫—É–ø–∫–∞ (Bid)</th>
                      </tr>
                      <tr>
                        <th class="ask-col">–¶–µ–Ω–∞</th>
                        <th class="ask-col">–û–±—ä—ë–º</th>
                        <th class="ask-col">–ö—É–º. –æ–±—ä—ë–º <span class="tooltip" title="–ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –æ–±—ä—ë–º ‚Äî —Å—É–º–º–∞ –æ–±—ä—ë–º–æ–≤ –æ—Ç –ª—É—á—à–µ–π —Ü–µ–Ω—ã –¥–æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏.">?</span></th>
                        <th></th>
                        <th class="bid-col">–ö—É–º. –æ–±—ä—ë–º <span class="tooltip" title="–ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π –æ–±—ä—ë–º ‚Äî —Å—É–º–º–∞ –æ–±—ä—ë–º–æ–≤ –æ—Ç –ª—É—á—à–µ–π —Ü–µ–Ω—ã –¥–æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏.">?</span></th>
                        <th class="bid-col">–û–±—ä—ë–º</th>
                        <th class="bid-col">–¶–µ–Ω–∞</th>
                      </tr>
                    </thead>
                    <tbody id="orderbook-body">
                      <!-- –î–∞–Ω–Ω—ã–µ —Å—Ç–∞–∫–∞–Ω–∞ –±—É–¥—É—Ç –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å—Å—è —Å—é–¥–∞ -->
                    </tbody>
                  </table>
                </div>
                <div id="orderbook-indicators" class="orderbook-indicators">
                  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã spread, –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å, VWAP –∏ —Ç.–¥. -->
                </div>
                <div id="orderbook-error" class="orderbook-error"></div>
              </div>
            </div>
            <!-- –í–∫–ª–∞–¥–∫–∞ –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è -->
            <div class="tab-content" id="probability-tab">
              <div class="probability-container">
                <h3>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è</h3>
                <form id="probability-form">
                  <label for="probability-symbol">–ú–æ–Ω–µ—Ç–∞:</label>
                  <select id="probability-symbol-select" style="width:120px">
                    <option value="BTCUSDT">BTCUSDT</option>
                    <option value="ETHUSDT">ETHUSDT</option>
                    <option value="BNBUSDT">BNBUSDT</option>
                    <option value="TRXUSDT">TRXUSDT</option>
                    <option value="ADAUSDT">ADAUSDT</option>
                    <option value="DOGEUSDT">DOGEUSDT</option>
                    <option value="XRPUSDT">XRPUSDT</option>
                    <option value="SOLUSDT">SOLUSDT</option>
                    <option value="DOTUSDT">DOTUSDT</option>
                    <option value="MATICUSDT">MATICUSDT</option>
                    <option value="SUIUSDT">SUIUSDT</option>
                    <option value="AVAXUSDT">AVAXUSDT</option>
                    <option value="LINKUSDT">LINKUSDT</option>
                  </select>
                  <input type="text" id="probability-symbol" value="BTCUSDT" style="width:90px" required placeholder="–î—Ä—É–≥–∞—è –º–æ–Ω–µ—Ç–∞">
                  <label for="probability-interval">–ò–Ω—Ç–µ—Ä–≤–∞–ª:</label>
                  <select id="probability-interval">
                    <option value="1m">1 –º–∏–Ω</option>
                    <option value="5m">5 –º–∏–Ω</option>
                    <option value="15m">15 –º–∏–Ω</option>
                    <option value="1h" selected>1 —á–∞—Å</option>
                    <option value="4h">4 —á–∞—Å–∞</option>
                    <option value="1d">1 –¥–µ–Ω—å</option>
                  </select>
                  <label for="probability-start">–ù–∞—á–∞–ª–æ:</label>
                  <input type="datetime-local" id="probability-start" required>
                  <label for="probability-end">–ö–æ–Ω–µ—Ü:</label>
                  <input type="datetime-local" id="probability-end" required>
                  <button type="submit">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
                </form>
                <div id="probability-result" class="probability-result"></div>
                <div id="probability-error" class="probability-error"></div>
                <div id="probability-chart-container" style="max-width:320px;margin:18px auto 0 auto;display:none;">
                  <canvas id="probability-chart"></canvas>
                </div>
              </div>
            </div>
            <!-- –í–∫–ª–∞–¥–∫–∞ –ù–æ–≤–æ—Å—Ç–∏ –ø–æ –∫—Ä–∏–ø—Ç–µ -->
            <div class="tab-content" id="news-tab">
              <div class="news-container">
                <h3>–ù–æ–≤–æ—Å—Ç–∏ –ø–æ –∫—Ä–∏–ø—Ç–µ</h3>
                <div id="news-list" class="news-list"></div>
                <div id="news-error" class="news-error"></div>
              </div>
            </div>
        </main>
    </div>

    <!-- –ó–∞—Ç–µ–º –Ω–∞—à–∏ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="arbitrage.js"></script>
    <script src="script.js"></script>
    <script src="monitor.js"></script>
    <script>
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è input[type='date']
    document.addEventListener('DOMContentLoaded', function() {
        var today = new Date();
        var yyyy = today.getFullYear();
        var mm = String(today.getMonth() + 1).padStart(2, '0');
        var dd = String(today.getDate()).padStart(2, '0');
        var formatted = yyyy + '-' + mm + '-' + dd;
        var start = document.getElementById('startDate');
        var end = document.getElementById('endDate');
        if (start) start.value = formatted;
        if (end) end.value = formatted;
    });

    // --- –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫ ---
    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Deactivate all tabs and content
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));

                // Activate the clicked tab and its content
                tab.classList.add('active');
                const activeTabContent = document.getElementById(tab.dataset.tab + '-tab');
                if (activeTabContent) {
                    activeTabContent.classList.add('active');
                }
            });
        });
    });

    // --- –õ–æ–≥–∏–∫–∞ –∫—Ä–∏–ø—Ç–æ-–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ ---
    (function() {
        if (!document.getElementById('crypto-converter')) return;

        const symbols = ["BTC", "ETH", "XRP", "BNB", "SOL", "ADA", "SUI", "LINK", "XLM", "AVAX", "TON", "LTC", "DOT", "USDT", "USDC", "RUB", "USD", "EUR"];
        const fiatSymbols = ["RUB", "USD", "EUR"];

        const amountInput = document.getElementById('cc-amount');
        const fromSelect = document.getElementById('cc-from');
        const toSelect = document.getElementById('cc-to');
        const swapBtn = document.getElementById('cc-swap');
        const convertBtn = document.getElementById('cc-convert');
        const autoBtn = document.getElementById('cc-auto');
        const resultEl = document.getElementById('cc-result');
        const exportBtn = document.getElementById('cc-export');
        const clearBtn = document.getElementById('cc-clear');
        const historyEl = document.getElementById('cc-history');

        let autoUpdateInterval = null;

        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ---
        function init() {
            symbols.forEach(sym => {
                fromSelect.add(new Option(sym, sym));
                toSelect.add(new Option(sym, sym));
            });
            fromSelect.value = "BTC";
            toSelect.value = "USDT";

            renderHistory();
            convert();

            // Event Listeners
            convertBtn.addEventListener('click', convert);
            swapBtn.addEventListener('click', swapCurrencies);
            autoBtn.addEventListener('click', toggleAutoUpdate);
            clearBtn.addEventListener('click', clearHistory);
            exportBtn.addEventListener('click', exportHistory);
        }

        // --- –õ–æ–≥–∏–∫–∞ API –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ ---
        async function getPrice(from, to) {
            const symbol = from + to;
            try {
                const res = await fetch(`https://api.binance.com/api/v3/ticker/price?symbol=${symbol}`);
                if (!res.ok) return null;
                const json = await res.json();
                return parseFloat(json.price);
            } catch (e) {
                return null;
            }
        }

        async function convert() {
            const amount = parseFloat(amountInput.value) || 1;
            const from = fromSelect.value;
            const to = toSelect.value;

            if (from === to) {
                resultEl.textContent = `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${amount} ${from}`;
                return;
            }

            resultEl.textContent = '–ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–∞...';

            try {
                let rate = await getPrice(from, to);
                let result;

                if (rate) {
                    result = amount * rate;
                } else {
                    const inverseRate = await getPrice(to, from);
                    if (inverseRate) {
                        result = amount / inverseRate;
                    } else {
                        throw new Error('–ü–∞—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    }
                }

                resultEl.textContent = `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${result.toFixed(6)} ${to}`;
                saveHistory(`${amount} ${from} = ${result.toFixed(6)} ${to}`);
            } catch (e) {
                resultEl.textContent = '–û—à–∏–±–∫–∞: –ø–∞—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.';
            }
        }

        function swapCurrencies() {
            [fromSelect.value, toSelect.value] = [toSelect.value, fromSelect.value];
            convert();
        }

        function toggleAutoUpdate() {
            if (autoUpdateInterval) {
                clearInterval(autoUpdateInterval);
                autoUpdateInterval = null;
                autoBtn.textContent = '–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ';
                autoBtn.style.backgroundColor = 'var(--primary-color)';
            } else {
                autoUpdateInterval = setInterval(convert, 10000);
                autoBtn.textContent = '–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
                autoBtn.style.backgroundColor = '#f44336'; // Crimson-like red
            }
        }

        // --- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–µ–π ---
        function getHistory() {
            return JSON.parse(localStorage.getItem('ccHistory') || '[]');
        }

        function saveHistory(entry) {
            let history = getHistory();
            history.unshift(entry);
            if (history.length > 20) {
                history = history.slice(0, 20);
            }
            localStorage.setItem('ccHistory', JSON.stringify(history));
            renderHistory();
        }
        
        function renderHistory() {
            const history = getHistory();
            historyEl.innerHTML = '<strong>–ò—Å—Ç–æ—Ä–∏—è:</strong><br/>' + history.map(h => `<div>${h}</div>`).join('');
        }

        function clearHistory() {
            localStorage.removeItem('ccHistory');
            renderHistory();
        }

        function exportHistory() {
            const history = getHistory().join('\\n');
            const blob = new Blob([history], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'conversion_history.txt';
            link.click();
            URL.revokeObjectURL(link.href);
        }

        init();
    })();
    </script>
</body>
</html> 